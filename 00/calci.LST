C51 COMPILER V6.23a  CALCI                                                                 07/20/2017 20:04:45 PAGE 1   


C51 COMPILER V6.23a, COMPILATION OF MODULE CALCI
OBJECT MODULE PLACED IN calci.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE calci.c BROWSE DEBUG OBJECTEXTEND

stmt level    source

   1          #include<reg51.h>
   2          
   3          sbit key_enb=P1^3;
   4          sfr ldata=0x80;
   5          sbit rs=P1^0;
   6          sbit rw=P1^1;
   7          sbit en=P1^2;
   8          sbit busy=P0^7;
   9          sbit buzzer=P1^5;
  10          
  11          void MSDelay(unsigned int value){
  12   1      unsigned int i,j;
  13   1      for(i=0;i<value;i++)
  14   1      for(j=0;j<1275;j++);
  15   1      }
  16          void lcdready(){
  17   1      
  18   1      busy=1;
  19   1      rs=0;
  20   1      rw=1;
  21   1      while(busy==1)
  22   1      {
  23   2      en=0;
  24   2      MSDelay(1);
  25   2      en=1;
  26   2      }
  27   1      return;
  28   1      }
  29          
  30          void lcdcmd(unsigned char value){
  31   1      lcdready();
  32   1      ldata=value;
  33   1      rs=0;
  34   1      rw=0;
  35   1      en=1;
  36   1      MSDelay(1);
  37   1      en=0;
  38   1      return;
  39   1      }
  40          
  41          void lcddata(unsigned char value){
  42   1      lcdready();
  43   1      ldata=value;
  44   1      rs=1;
  45   1      rw=0;
  46   1      en=1;
  47   1      MSDelay(1);
  48   1      en=0;
  49   1      return;
  50   1      }
  51          
  52          void function(){
  53   1       int  x=0;
  54   1       int w,z,o,s;
  55   1       int c,d,e,f;
C51 COMPILER V6.23a  CALCI                                                                 07/20/2017 20:04:45 PAGE 2   

  56   1       unsigned char a,b;
  57   1       unsigned char y;
  58   1      key_enb=1;
  59   1      p:
  60   1      lcddata('0');
  61   1      lcdcmd(0x06);
  62   1      lcddata('0');
  63   1      m:
  64   1      P0=0xFF;//make p0 input
  65   1      MSDelay(1);
  66   1      key_enb=0;//H-to-L for taking key value
  67   1      MSDelay(1);
  68   1      y=P0;//input value
  69   1      key_enb=1;//high again
  70   1      P0=0xFF;//ready for input again
  71   1      if(y==0xFF)goto m;
  72   1      else{
  73   2      
  74   2      MSDelay(20);//debounce of 20ms
  75   2      
  76   2      key_enb=0;
  77   2      y=P0;
  78   2      key_enb=1;
  79   2      P0=0xFF;
  80   2      if(y==0x7F){lcdcmd(0x80);lcdcmd(0x01);
  81   3      x++;
  82   3      if(x<10)
  83   3      {a='0';
  84   4      b=x+0x30;
  85   4      lcddata(a);
  86   4      lcdcmd(0x06);
  87   4      lcddata(b);}
  88   3      else if(x>99){
  89   4      x=0;
  90   4      a='0';
  91   4      b='0';
  92   4      lcddata(a);
  93   4      lcdcmd(0x06);
  94   4      lcddata(b);
  95   4      }
  96   3      else {
  97   4      b=x%10;
  98   4      b=b+0x30;
  99   4      a=x/10;
 100   4      a=a+0x30;
 101   4      lcddata(a);
 102   4      lcdcmd(0x06);
 103   4      lcddata(b);
 104   4      }
 105   3      
 106   3      }
 107   2      else if(y==0xBF){
 108   3      lcdcmd(0x80);lcdcmd(0x01);
 109   3      x--;
 110   3      if(x<0){
 111   4      x=99;
 112   4      a='9';
 113   4      b='9';
 114   4      lcddata(a);
 115   4      lcdcmd(0x06);
 116   4      lcddata(b);
 117   4      }
C51 COMPILER V6.23a  CALCI                                                                 07/20/2017 20:04:45 PAGE 3   

 118   3      
 119   3      else if(x<10)
 120   3      {a='0';
 121   4      b=x+0x30;
 122   4      lcddata(a);
 123   4      lcdcmd(0x06);
 124   4      lcddata(b);}
 125   3      
 126   3      else {
 127   4      b=x%10;
 128   4      b=b+0x30;
 129   4      a=x/10;
 130   4      a=a+0x30;
 131   4      lcddata(a);
 132   4      lcdcmd(0x06);
 133   4      lcddata(b);
 134   4      }
 135   3      
 136   3      }
 137   2      else if(y==0xDF){lcdcmd(0x80);lcdcmd(0x01);
 138   3      lcddata('-');
 139   3      w=x;
 140   3      o=4;
 141   3      }
 142   2      else if(y==0xEF){lcdcmd(0x80);lcdcmd(0x01);
 143   3      lcddata('/');w=x;
 144   3      o=3;
 145   3      }
 146   2      else if(y==0xF7){lcdcmd(0x80);lcdcmd(0x01);
 147   3      //output (delete)
 148   3      buzzer=1;
 149   3      buzzer=0;
 150   3      goto p;
 151   3      }
 152   2      else if(y==0xFB){lcdcmd(0x80);lcdcmd(0x01);
 153   3      lcddata('*');
 154   3      o=2;
 155   3      w=x;
 156   3      }
 157   2      else if(y==0xFD){lcdcmd(0x80);lcdcmd(0x01);
 158   3      lcddata('+');
 159   3      w=x;
 160   3      o=1;
 161   3      }
 162   2      else if(y==0xFE){lcdcmd(0x80);lcdcmd(0x01);
 163   3      z=x;
 164   3      if(o==1){
 165   4      s=w+z;
 166   4      if(s<10)
 167   4      {a='0';
 168   5      b=s+0x30;
 169   5      lcddata(a);
 170   5      lcdcmd(0x06);
 171   5      lcddata(b);}
 172   4      else if(s<100) {
 173   5      b=s%10;
 174   5      b=b+0x30;
 175   5      a=s/10;
 176   5      a=a+0x30;
 177   5      lcddata(a);
 178   5      lcdcmd(0x06);
 179   5      lcddata(b);
C51 COMPILER V6.23a  CALCI                                                                 07/20/2017 20:04:45 PAGE 4   

 180   5      }
 181   4      else if(s<1000){
 182   5      c=s%10;
 183   5      d=s%100;
 184   5      d=d-c;
 185   5      d=d/10;
 186   5      e=s/100;
 187   5      a=e+0x30;
 188   5      lcddata(a);
 189   5      a=d+0x30;
 190   5      lcddata(a);
 191   5      a=c+0x30;
 192   5      lcddata(a);
 193   5      }
 194   4      
 195   4      }
 196   3      else if(o==2){
 197   4      s=w*z;
 198   4      if(s<10)
 199   4      {a='0';
 200   5      b=s+0x30;
 201   5      lcddata(a);
 202   5      lcdcmd(0x06);
 203   5      lcddata(b);}
 204   4      
 205   4      else if(s<100) {
 206   5      b=s%10;
 207   5      b=b+0x30;
 208   5      a=s/10;
 209   5      a=a+0x30;
 210   5      lcddata(a);
 211   5      lcdcmd(0x06);
 212   5      lcddata(b);
 213   5      }
 214   4      else if(s<1000){
 215   5      c=s%10;
 216   5      d=s%100;
 217   5      d=d-c;
 218   5      d=d/10;
 219   5      e=s/100;
 220   5      a=e+0x30;
 221   5      lcddata(a);
 222   5      a=d+0x30;
 223   5      lcddata(a);
 224   5      a=c+0x30;
 225   5      lcddata(a);
 226   5      
 227   5      }
 228   4      else if(s<10000){
 229   5      c=s%10;
 230   5      d=s%100;
 231   5      d=d-c;
 232   5      d=d/10;
 233   5      s=s/100;
 234   5      e=s%10;
 235   5      f=s/10;
 236   5      a=f+0x30;
 237   5      lcddata(a);
 238   5      a=e+0x30;
 239   5      lcddata(a);
 240   5      a=d+0x30;
 241   5      lcddata(a);
C51 COMPILER V6.23a  CALCI                                                                 07/20/2017 20:04:45 PAGE 5   

 242   5      a=c+0x30;
 243   5      lcddata(a);
 244   5      
 245   5      }
 246   4      
 247   4      
 248   4      }
 249   3      else if(o==3){
 250   4      s=w/z;
 251   4      if(s<10)
 252   4      {a='0';
 253   5      b=s+0x30;
 254   5      lcddata(a);
 255   5      lcdcmd(0x06);
 256   5      lcddata(b);}
 257   4      
 258   4      else if(s<100) {
 259   5      b=s%10;
 260   5      b=b+0x30;
 261   5      a=s/10;
 262   5      a=a+0x30;
 263   5      lcddata(a);
 264   5      lcdcmd(0x06);
 265   5      lcddata(b);
 266   5      }
 267   4      
 268   4      }
 269   3      else if(o==4){
 270   4      s=w-z;
 271   4      if(s<0){
 272   5      s=s*(-1);
 273   5      a=s+0x30;
 274   5      lcddata('-');
 275   5      lcdcmd(0x06);
 276   5      lcddata(a);
 277   5      }
 278   4      else if(s<10)
 279   4      {a='0';
 280   5      b=s+0x30;
 281   5      lcddata(a);
 282   5      lcdcmd(0x06);
 283   5      lcddata(b);}
 284   4      
 285   4      else if(s<100) {
 286   5      b=s%10;
 287   5      b=b+0x30;
 288   5      a=s/10;
 289   5      a=a+0x30;
 290   5      lcddata(a);
 291   5      lcdcmd(0x06);
 292   5      lcddata(b);
 293   5      }
 294   4      }
 295   3      
 296   3      }}
 297   1      goto m;
 298   1      }
 299          
 300          void main(){
 301   1      
 302   1      buzzer=0;
 303   1      lcdcmd(0x38);
C51 COMPILER V6.23a  CALCI                                                                 07/20/2017 20:04:45 PAGE 6   

 304   1      lcdcmd(0x08);
 305   1      lcdcmd(0x01);
 306   1      lcdcmd(0x06);
 307   1      lcdcmd(0x0C);
 308   1      function();
 309   1      }
 310          
 311          
 312          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1291    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      19
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
